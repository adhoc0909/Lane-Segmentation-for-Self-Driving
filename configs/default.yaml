project:
  name: sdlane-baseline
  seed: 42

paths:
  sdlane_root: null
  out_dir: outputs
  run_name: exp001

data:
  splits:
      train:
        dir: "train"
        list: "train_list.txt"
      test:
        dir: "test"
        list: "test_list.txt"
  image_size: [640, 416]   # W,H
  #image_size: [1024, 1024]
  lane_thickness: 6
  val_ratio: 0.2
  num_workers: 4
  pin_memory: true
  persistent_workers: true
  use_precomputed_masks: true
  mask_subdir: "masks"      # precompute 스크립트가 저장한 폴더명
  mask_ext: "png"
  fallback_to_json: false    # 마스크 없으면 JSON로 생성해서 진행(디버깅 끝나면 false 추천)
  lane_thickness: 6

augment:
  enabled: true
  hflip_p: 0.0
  brightness_contrast_p: 0.2
  gamma_p: 0.1
  blur_p: 0.05

model:
  arch: unet
  encoder: resnet34
  pretrained: true
  in_channels: 3
  num_classes: 1

train:
  early_stop:
    enabled: true
    patience: 15        # 개선 없으면 몇 epoch 기다릴지
    min_delta: 0.0      # 개선으로 인정할 최소 변화량
    warmup_epochs: 0    # 0이면 바로 적용, 예: 5로 두면 5epoch 이후부터 early stop
  device: cuda
  batch_size: 8
  epochs: 20
  lr: 0.0003
  weight_decay: 0.00001
  amp: true
  grad_clip_norm: 0.0
  scheduler:
    name: cosine
    t_max: 20
    step_size: 10
    gamma: 0.1
  checkpoint:
    save_every: 10
    metric: dice
    mode: max
  resume: null   # 이어학습 안 하면 null, 하면 모델 경로


loss:
  name: bce_dice
  bce_weight: 0.5
  dice_weight: 0.5
  smooth: 1.0

eval:
  threshold: 0.5

infer:
  weights: null
  input: null
  output: outputs/infer

wandb:
  enabled: true          # false면 wandb 완전 비활성
  project: "lane-segmentation"
  entity: null           # 개인 계정이면 null
  watch: false           # true면 gradient/parameter 추적 (무거움)
