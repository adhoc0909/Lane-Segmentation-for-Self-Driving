project:
  name: sdlane-baseline
  seed: 42

paths:
  sdlane_root: null
  out_dir: outputs
  run_name: exp001

data:
  splits:
      train:
        dir: "train"
        list: "train_list.txt"
      test:
        dir: "test"
        list: "test_list.txt"
  image_size: [640, 400]   # W,H
  lane_thickness: 6
  val_ratio: 0.2
  num_workers: 4
  pin_memory: true
  persistent_workers: true
  use_precomputed_masks: true
  mask_subdir: "masks"      # precompute 스크립트가 저장한 폴더명
  mask_ext: "png"
  fallback_to_json: false    # 마스크 없으면 JSON로 생성해서 진행(디버깅 끝나면 false 추천)
  lane_thickness: 6

augment:
  enabled: true
  hflip_p: 0.0
  brightness_contrast_p: 0.2
  gamma_p: 0.1
  blur_p: 0.05

model:
  arch: unet
  encoder: resnet34
  pretrained: true
  in_channels: 3
  num_classes: 1

train:
  device: cuda
  batch_size: 8
  epochs: 20
  lr: 0.0003
  weight_decay: 0.00001
  amp: true
  grad_clip_norm: 0.0
  scheduler:
    name: cosine
    t_max: 20
    step_size: 10
    gamma: 0.1
  checkpoint:
    save_every: 1
    metric: dice
    mode: max

loss:
  name: bce_dice
  bce_weight: 0.5
  dice_weight: 0.5
  smooth: 1.0

eval:
  threshold: 0.5

infer:
  weights: null
  input: null
  output: outputs/infer
