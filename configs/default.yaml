project:
  name: sdlane-baseline
  seed: 42

paths:
  sdlane_root: null
  out_dir: outputs
  run_name: exp001

data:
  image_size: [960, 540]   # W,H
  lane_thickness: 6
  val_ratio: 0.2
  num_workers: 4
  pin_memory: true
  persistent_workers: true

augment:
  enabled: true
  hflip_p: 0.0
  brightness_contrast_p: 0.2
  gamma_p: 0.1
  blur_p: 0.05

model:
  arch: unet
  encoder: resnet34
  pretrained: true
  in_channels: 3
  num_classes: 1

train:
  device: cuda
  batch_size: 8
  epochs: 20
  lr: 0.0003
  weight_decay: 0.00001
  amp: true
  grad_clip_norm: 0.0
  scheduler:
    name: cosine
    t_max: 20
    step_size: 10
    gamma: 0.1
  checkpoint:
    save_every: 1
    metric: dice
    mode: max

loss:
  name: bce_dice
  bce_weight: 0.5
  dice_weight: 0.5
  smooth: 1.0

eval:
  threshold: 0.5

infer:
  weights: null
  input: null
  output: outputs/infer
